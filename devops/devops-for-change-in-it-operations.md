IT 운용 체제 변화를 위한 데브옵스

## 1. DevOps 알아보기
* DevOps의 개요와 DevOps와 관련된 키워드를 알아본다. DevOps의 탄생 배경과 DevOps가 구체적으로 어떤 정책과 도구로 유지되는지 설명한다. 

### 1.1 DevOps의 등장배경
  * DevOps는 Dev(개발)과 Ops(운용)이 긴밀히 협조, 엽계하여 **비즈니스 측면의 가치를 높이는 근무 방식과 문화**를 말한다.
  * DevOps에서는 개발과 운용이 협업하여 팀간의 호버헤드를 상당히 해소할 수 있게 됨으로써 **간소화를 통해 개발에 속도를 부여**하고, **서로간의 이해에 기반하여 변경에 유연성을 부여**한다.
  * 일하는 방법이면서, 개발에 한정된 방법이 아니라, 팀 빌딩, 개발 프로세스 설계 등의 조직 구성, 더 나아가 문화의 형성까지 포함하고 있는 사고방식  
#### 1.1.1 DevOps의 탄생 배경
  * 다음과 같은 질문의 해결 방법을 도출해 내기 위해 DevOps가 나오게 되었다.
      * 계속적으로 발전해 온 개발 방법을 토대로 하여 '더욱 효율적으로 개발하려면 어떻게 하면 좋을까?'
      * '보다 좋은 방안으로 개선하려면 어떻게 하면 좋을까?'
  * DevOps가 탄생하게 된 foundation 2 가지
    * **애자일 개발**에 의한 **계속적인 개발**로의 변화
    * **계속적인 개발**로 인해 나타나는 **운용 과제**
  * 애자일 개발 (agile software development)의 다양한 도구와 방법에서 생겨난 운용과제가 DevOps라는 것을 탄생 시켰고, 현재의 DevOps 개념 및 방법, 도구를 지원하고 있다.

#### 1.1.2 애자일 개발에 의학 계속적 개발로 변화

- 과거: 워터폴(waterfall) 개발 방법론
  - 1980년대
  - 개발공정을 분할하고 이전 공정이 끝나지 않으면 다음 공정이 진행 될 수 없는 개발 형태를 가지고 있다.
    - 개발 공정 예: 계획 -> 요건 정의 -> 설계 -> 개발(설치) -> 테스트 -> Release -> 운용
  - 각 공정마다 확실하게 완료된 상태로 진행해감으로써 시스템 전체의 품짐을 향상시키는 방식이므로 매우 많은 시간이 필요하다.
  - 현재의 웹 서비스에서는 상당히 짧은 기간에 기능 추가/개선 요구가 발생하고 있고, 워터폴 형태의 개발은 이와 같이 짧은 기간에 점차적으로 요구 사항이 적용되고 상세한 변경이 반복되는 즉, **유연성이 필요한 개발에는 대응이 매우 어렵다.**
- 최근: 애자일(agile) 개발 방법론
  - 서비스를 정책적으로 실시하면서 피드백을 받아 개발을 여러 번 반복하는 "프로토타입 모델" 과 소규모 개발을 전제로 필요한 최소한의 요건을 적용한 성과물을 만들어 Release 한다.
  - 고객의 피드백을 받아서 계속적인 개선을 반복한다.
  - 짧은 기간에 개발 사이클을 진행할 수 있는 기반을 마련했다.
  - 기능의 추가가 빈번하게 이루어 진다.
    - 여러번 이루어지는 업데이트 횟수에 대응하고 계속적으로 개선을 반복하기 때문에 계속성 및 효율을 추구하는 개발 방법이나 도구가 생겨났고, **지속적 통합(continuous integration)**이라는 개념이 생겨났다.
- 그러나,
  - 개발자는 개발 범위 효율화 및 자동화를 추진하는, 지속적 통합이라는 성과물 생성과 관련된 효율화를 진행했지만, 어떻게 하여도 용 측면 과제가 존재한다는 것을 깨닫게 되었다.

#### 1.1.3 계속적 개발로 나타나기 시작한 운용 과제

- Agile 2008 Conference
  - Agile Infrastructure & Operations - Patrick Debois
    - "운용팀은 개발팀으로부터 고의적으로 분리되어 있다 라는 현상"에 대하여 언급하고 있다.
    - 운용 측면 입장
      - 문제점: 기술적 (개발관련) 부담을 떠안게 됨
        - 예시
          - 어떤 영향을 불러올지 몰라서 업데이트 패치를 적용하지 않았다
          - 하드웨어 기술 지원 기간이 지나버렸다
          - 신속한 보안을 위해 스크립트를 재시작한다
          - 마이그레이션이 불완전하게 끝난다
      - 해결책:
        -  데일리 스크럼 (일일 회의)를 통해 진행 방향에 대한 해결책을 도출
        - 팀 멤버의 관심 여부에 따라 우선 순위를 매기거나 테스크에 페어로 대응
        - Information radiation (정보 공유)를 통해 정보가 자연스럽게 전해지는 상태를 형성
    - 개발 측면 입장
      - 문제점: 기능 요건 외의 모니터링, 이중화, 백업, OS 등 비기능 요건을 소홀하게 취급함 (운용관련)
        - 예시
          - 스페셜리스트들만 존재한다
          - 누구도 다른일을 하지 않는다
          - 추가 기능 및 개선 사항을 관리하는 리스트에는 To Do 만 존재한다
          - 어플리케이션 내부에 대한 지식이 없다
          - 프로덕트 매니저나 운용 매니저 등 팀마다 매니저가 존재하기 때문에 프로덕트 책임자가 다수 존재하여 정말 중요한 요건이 보이지 않게 된다
      - 해결책:
        - Cross Functional Team: 인프라팀을 포함시킨 애자일 개발
        - 인프라 요건을 기존보다 더욱 이른 단계에서 가시화
        - 과제에 대해서는 과제의 주인을 명확히 하는 것
- Agile 2009 Conference
  - Agile Infrastructure - Andrew Shafer
    - Wall of Confusion (개발과 운용 사이의 혼란을 지칭하는 말)
    - 이 벽을 넘어서 개발과 운용이 서로 간의 영역으로 들어가 애자일 개발처럼 인프라가 운용되는, 애자일 인프라를 실현하는 수단으로써 Infrastructure is code 라는 주제로 방법을 설명하고 있다
      - 인프라의 컨피규레이션 버전 관리
      - 원스톱 디플로이
      - 모니터링
      - 인프라의 지속적 통합
    - 코드화된 구성 정보를 동일한 소프트웨어 관리 시스템의 repository에 적재하여 가시화 하는 것을 언급한다. 이는 운용 과제에 대한 해결책으로써 개발과 운용이 정보를 공유하는 가시화 과정을 통해 인프라의 코드화가 가속화되어 Infrastructure as Code를 형성하는 기반이 된다.
  - 운용 과제 해결책으로써 인프라 구성 관리 도구
    - 인프라 구성 관리 (Provisioning) 도구
      - 서버와 스토리지, 네트워크 등 인프라에 대한 설정을 수행함 
        - 여러 서버를 Web 서버 그룹, DB 서버 그룹처럼 분류하고 각각의 그룹에 대하여 설정을 배포하거나 명령을 실행할 수 있다.
      - 프로비저닝 영역
        - 오케스트레이션
          - 디플로이나 노드 간 연계 등 복수의 서버에 대한 설정이나 관리를 말한다
          - 다른 말로, 개발 결과물을 복수의 서버로 일괄 Deploy하듯이 여러대에 동일한 설정을 하는 작업을 말한다
        - 컨피규레이션
          - 부트 스트래핑이 끝난 서버에 대한 OS 설정 변경이나 미들웨어의 설정 적용 등을 말한다
        - 부트 스트래핑
          - 가상 머신이나, OS 설치를 말한다
          - 인프라 환경을 제공하는 클라우드 서비스(Iaas)에 가상머신의 구성과 컨테이너 생성에 해당
          - 이용자 관점
            - 인프라 운용 담당자가 하드웨어에 기본이 되는 OS를 설치하는 경우에 이용되는 도구
          - 인프라 담당자의 담당 영역도 하드웨어 보단 소프트웨어에 가까워지고 있음. 부트스트래핑을 이용한 작업의 수행은 많이 없어짐.
      - Puppet, Chef, Ansible 로 인해 컨피규레이션과 오케스트레이션의 경계선이 사라지고 있다.
  - Infrastructure as Code와 DevOps
    - **Infrastructure as Code** = **인프라 구성 관리 도구(프로비저닝 툴)에 의한 설정의 코드화 및 구성 정보화** 전체를 지칭함
    - 모든 인프라는 이 설정 및 구성 정보에 의해서만 구축 및 설정이 변경됨
      - 특히 컨피규레이션 도구는 직접 실제 기기에 설정을 하는 대신, 서버나 미들웨어의 구성 정보와 설정 정보를 정의 파일에 기재하고 도구를 이용하여 정의 파일대로 설정을 수행하여 "계속적인 개발로 인해 나타난 운용 과제"의 해결 방법이 되는 도구 그룹이다.
      - 정의 파일에 기술하는 것만으로 인프라의 구성과 설정을 선언으로 기재할 수 있게 되기 때문에, 인프라 플랫폼별 차이를 흡수하기 위한 지식은 필요하지 않게 된다. 이 때문에, 어플리케이션 엔지니어도 구성 정보를 기술하는 구축할 수 있게 된다.
    - 인프라 구성과 설정의 구성 정보화에 의해 소프트웨어 영역으로 전환되고, 인프라의 구성과 설정에 있어서도 소프트웨어 개발 방법을 적용하는 것이 가능하게 됨
      - 설정을 변경하기 위해 코드와 같은 구성 정보를 기술
      - 구성을 일반적인 어플리케이션 개발과 같은 방법으로 테스트 가능한 도구를 사용하여 테스트함
      - 완성된 구성 정보는 코드와 마찬가지로 버전을 관리하는 것과 같이, 개발 부문에서 생겨난 애자일 개발과 같은 계속적인 개발 방법을 인프라 구축 및 운용에도 적용하는 것이 가능하게됨
      - 컨피그레이션 도구에서 프로그래밍 언어보다 학습 비용이 낮은 DSL (Domain specific langauges)로 인프라 구성과 컨피그를 기술하게 있게됨
        - 인프라 엔지니어도 일반적인 미들웨어의 컨피그를 습득하는 정도의 학습비용으로 기술하는 것이 가능하게 됨
        - 따라서 인프라 엔지니어도, 어플리케이션 엔지니어도 인프라 설정 및 운용에 대하여 서로의 방향에 다가가는 것이 가능하게 됨
  - 컨피규레이션 도구의 역사와 특징
    - CFEngine
      - 1993
      - Mark Burgess 
      - Open Source
      - "컨피규레이션 도구의 조상"
      - C 언어로 기술되어 있어 매우 가볍게 동작하는 특징이 있음.
      - 시스템 간 차이를 C 언어 등으로 확장하지 않고 DSL을 이용하여 구성을 기술할 수 있는 점
    - Puppet
      - 2005
      - Luke Kanies
      - C 언어로 기술 된 CFEngine과 비교해서, Ruby로 기술되어 있기 때문에 휴대성이 뛰어나다.
      - Manifest로 불리는 구성정보 파일에 독자적인 DSL로 구성을 선언하는 것이 가능하다.
    - Chef
      - Adam Jacob
      - Ruby 와 Erlang으로 작성
      - 레시피로 불리는 구성 정보 파일에 Ruby 기반의 DSL로 구성을 기술하고 Ruby의 문법 등을 그대로 사용할 수 있는 것이 특징
    - Ansible
      - 2012
      - Michael Dehaan
      - Python으로 작성
      - YAML형식으로 설정 및 구성 정보 표현
      - 실제 기계에 대한 설정을 수행하는 실행 모듈을 다양한 언어로 기술할 수 있는 것이 특징

#### DevOps의 탄생과 역사

그래서, 애자일 개발로 인해 계속적 개발로 개선이 진행되었고, 운용 과제가 발생하게 되었고, 이것을 기반으로 데브옵스의 탄생 경위와 역사가 펼쳐진다.

- DevOps의 태동
  - 2009년 O'Reilly 주최 벨로시티 (Velocity) 컨퍼런스에서 Flickr의 엔지니어 2명이 10+ Deploys per Day: Dev and Ops Cooperation at Flickr 이라는 프레젠테이션을 했다.
    - 프레젠테이션 내용: 
      - 저통적인 조직에서의 개발 부문와 운용 부문은 대립 관계에 있으며, 개발 부분은 사업을 위해 서비스에 변화를 주려 하지만, 운용 부문은 변화를 싫어한다 (운용 부문의 미션은 안정적 가동이기 떄문에).
      - 1. 운용 부문에 있어서 서비스에 예상치 못한 사고가 일어난다. 
        2. 개발 부문이 변경된 내용을 운용 부문에 말하지 않으니
        3. 운용 부문은 항상 NO 라고 하기 떄문에 (그래서 임의로 변경한다)
        4. 이하 반복
      - 운용 부문의 미션은 안정적 가동도 최적화도 아니다. 운용 부문의 미션은 비즈니스를 유효하게 하는 것이다 (개발 부문도 마찬가지다)
        - 세상의 변화에 대응하기 위해 개발 부문이 비즈니스에 변화를 주고 싶어 하지만, 운용 부문은 안정을 위해 사업으로 인한 변화를 가하고 싶지 않아한다. 그러나 뒤돌아 보면 **양쪽의 목적은 일치한다**.
        - -> 변화의 위험을 도구와 문화로 낮춘다.
      - 변화에 대응하기 위한 도구
        - Automated Infrastructure (인프라 자동화)
        - Shared version control (버전 관리 공유)
        - One step build and deploy (원 스텝 빌드와 deploy)
        - Feature Flags (어플리케이션 기능의 유효/무효를 설정 파일로 관리하는 것)
        - Shared metrics (metrics 공유)
        - IRC and IM robots (IRC와 인스턴트 메신저 bot)
      - 변화에 대응하기 위한 문화
        - Respect (존중)
        - Trust (신뢰)
        - Healthy attitude about failure (실패에 대한 긍정적인 자세)
        - Avoiding Blame (비난을 하지 않는 것)
      - 이 프레젠테이션에서 구체적 수단에 대해 자세하게 언급하지 않았지만, 하루에 10번이나 deploy 하는 것은 그 당시에는 생각할 수 없는 것이었으므로 개발에 관계되는 모든 사람에게 의미 있는 인상을 남겼다고 한다.
- DevOps 탄생
  - 2009년 10월 30일. 벨기에. DevOpsDays Ghent 2009. 패트릭 드부와가 처음으로 DevOps라는 말을 언급

#### 1.1.5 정리

- DevOps가 탄생하기 전 애자일 개발에 의한 계속적인 개발로의 변화와, 계속적인 개발로 인해 나타난 운용 과제가 있었다. 그 과제를 어떻게 해결할 것인가 개발자들이 고민한 결과 DevOps가 탄생하게 되었다.

### 1.2 DevOps를 알자

- 추상화

  - 모든 리소스를 추상화 하여 어떠한 플랫폼의 차이도 흡수하고, 전문성과 복잡성을 절감하는것

- 추상화의 세분화

  - 동일한 구격이나 룰에 의해서 단일 기기 또는 복수의 상이한 프로그램이나 기기를 불러올 수 있는 것 - 표준화
  - 실제로는 존재하지 않는 무엇인가로 되는 것- 가상화
  - 표준화, 가상화에 대한 접근은 OS, 서버, 스토리지, 네트워크에서도 동일한 모습으로 실행되며 개별 하드웨어 관련 노하우가 소프트웨어로 점차 도입되고 있다.

- OS 추상화

  - Jail 방안을 기반으로한 Linux-VServer 개발이 시작되어 하나의 서버에서 CPU 시간, 메모리, 네트웤, 등 자원(resource)을 분할하여 복수의 Linux 가상 서버를 작동시키는 방안이 생겨났다
  - 2005년에 솔라리스 컨테이너의 등장, 2008년에 Linux에도 LXC (The Linux Containers Project)가 생겨나 개별 프로세스 단위로 네임 스페이스에 의한 자원 분리를 실시함으로써 가상화를 실현하는 컨테이너 라는 개념이 퍼졌다
  - 2013년 dotCloud(현재 도커)에서  LXC를 이용하여 구현된 컨테이너 도커가 오픈소스화 되어 폭발적으로 보급되었다. 현재 Docker는 Go 언어로 독자적으로 구현하고 플랫폼간 이식성(portability)를 향상시키고 있다.

- 물리서버의 추상화

  - PC 위에 가상 PC를 만드느 컨셉으로 1999년 VMware에서 VMware 1.0이 등장.
    - 이것으로 모든 물리적 하드웨어를 소프트웨어로 표현하고 OS 위에서 완전히 다른 OS 를 구동시킬 수 있게 되었다.
  - 가상화된 하드웨어를 가상 머신 이라고 하고
  - 가상 머신을 탑재한 원래의 OS를 가상화 호스트 / 하이퍼바이저 라고함 (VM 을 생성하고 실행하는 프로세스)
    - Hypervisor 방식 - 물리 하드웨어와 하이퍼바이저 사이에 OS 가 있음 (windows / linux)
    - Baremetal Hypervisor 방식 - 물리 하드웨어 위에 하이퍼바이저 설치
  - 2003년 Xen이라는 리눅스 커널을 하이퍼바이저화하는 기술이 등장
  - 2006년 KVM (kernel based virtual base)이라는 가상화 기술이 등장
  - 2007년 리눅스 커널에 KVM이 통합되어 리눅스 디스트리뷰션에서는표준적인 서버 가상화를 도입할 수 있게 도미.
  - 2009년에는 VMware vSphere가 등장

- OS 추상화와 서버 추상화 양쪽의 장점을 얻기 위해서 가상 머신 위에 컨테이너를 구성하는 하이브리드 구성이 주목을 받음

  